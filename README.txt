Крысиные бега

Условие:
Однажды британским ученым стало скучно и они решили провести следующий эксперимент. Они сконструировали лабиринт, состоящий из N комнат и M переходов между ними, и запустили в первую комнату сто лабораторных крыс (предварительно пронумеровав их). За один переход в любую соседнюю комнату каждая крыса получала кусочек сыра. Ученые же записывали, какая крыса бежала по какому маршруту.

После того, как каждая крыса пробежала по K переходам, сыр закончился и ученые стали смотреть на результаты. Неожиданно оказалось, что все крысы бежали по разным маршрутам… Ученые очень обрадовались и начали даже писать статью на тему индивидуализма крыс, но тут один из них поинтересовался – а сколько же всего существует различных маршрутов длины K, которые начинаются в первой комнате?..

Ученые начали считать, но сбились уже на 632-м маршруте –- они все же психологи, а не математики… Однако им этого хватило, чтобы понять, что маршрутов может быть ОЧЕНЬ много –- поэтому они хотят получить хотя бы остаток от ответа по модулю 109+7. Помогите им –- и они сделают вас соавтором статьи!

Формат ввода:
В первой строке входного файла находится три числа — N, M и K (1 ≤ N ≤ 50, 0 ≤ M ≤ 105, 0 ≤ K ≤ 109) – количество комнат в лабиринте, количество переходов между ними и длина маршрута каждой из крыс.

В следующих M строках содержится информация о переходах между комнатами: в каждой строке содержатся пары чисел вида a b (1 ≤ a, b ≤ N, a может быть равно b), обозначающие наличие перехода, ведущего из комнаты с номером a в комнату с номером b. Во входном файле могут быть одинаковые пары чисел a b, обозначающие разные переходы, ведущие из комнаты a в комнату b.

Все крысы начинают бежать из комнаты номер 1.

Формат вывода:
Выведите в выходной файл единственное число P – количество различных маршрутов, по которым могли пробежать крысы, по модулю 109+7.

Пример:
Ввод:
3 4 2
1 2
1 3
2 3
3 1

Вывод:
2

Алгоритм решения и доказательство его правильности находится в файле theory_solution.pdf